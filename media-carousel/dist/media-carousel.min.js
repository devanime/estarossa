!function(s,l){Estarossa.addAction(Estarossa.REGISTER,function(){var n=Estarossa.applyFilters("media-carousel/owl-settings",{margin:10,items:1,dots:!1,nav:!0,navText:["&lsaquo;","&rsaquo;"],responsive:{0:{items:2},768:{items:3}}});function t(e){this.bus=e,this.currentIndex=1,this.currentPage=0,e.addAction("selected",this.onSelect,10,this),e.addAction("navigate",this.onNavigate,10,this)}function i(e){var i=this;i.$el=e,i.$caption=e.parent().find(".media-carousel__caption"),i.index=e.parents(".owl-item").index()+1,i.type=e.attr("data-video-id")?"video":"image",i.id=e.attr("data-video-id")||e.attr("data-image-id")}function e(e){var i=this;i.$container=e,i.bus=new EventManager,i.bus.resetting=!1,i.selection=new o(e.find(".media-carousel__selection-wrap"),i.bus),i.slider=new a(e.find(".media-carousel__slides"),i.bus),Estarossa.addAction(Estarossa.HASH_STATE_CHANGE,i.reset,10,i),i.reset(),l(s).on("load",function(){new t(i.bus)})}function o(e,i){var t=this;t.bus=i,t.$wrap=e,t.$selection=e.find(".media-carousel__selection"),t.$initial=t.$selection.find(".media-carousel__selection__initial"),t.$captionToggle=e.find(".media-carousel__selection__toggle-caption"),t.$selectionCaption=e.find(".media-carousel__selection__caption"),t.$captionToggle.click(function(e){t.$wrap.toggleClass("media-carousel__selection-wrap--caption-active")}),t.bus.addAction("selected",t.onSelection,10,t)}function a(e,i){var t=this;t.$slider=e,t.bus=i,t.$links=t.$slider.find(".media-carousel__link"),t.$links.on("click",t.onClick.bind(t)),t.$slider.addClass("owl-carousel owl-theme").owlCarousel(n).on("changed.owl.carousel",t.onSlideChange.bind(t)),t.$nav=t.$slider.find(".owl-nav"),t.$nav.find("button").data("gtm",0),t.$nav.find("svg").length&&t.$nav.addClass("owl-nav--svg"),Estarossa.addAction(Estarossa.LAYOUTEND,t.alignNav,10,t),t.bus.addAction("selected",t.onSelect,10,t)}t.prototype={onSelect:function(e){this.currentIndex!==e.index&&(this.currentIndex=e.index,Estarossa.doAction(Estarossa.GTM_INTERACTION,{type:"carouselSelect",$el:e.$el,label:e.$caption.text()||e.$el.find("img").attr("alt"),index:e.index,media:e.type}))},onNavigate:function(e){var i=e.item.index,t=i>this.currentPage?"next":"prev";this.currentPage=i,Estarossa.doAction(Estarossa.GTM_INTERACTION,{type:"carouselNavigate",$el:l(e.target),label:t,index:i})}},e.prototype={reset:function(){var e=this;e.bus.resetting=!0,e.selection.reset(!0),e.slider.reset(),e.bus.resetting=!1}},o.prototype={reset:function(e){var i=this;Estarossa.doAction(Estarossa.VIDEO_PAUSE),i.$selection.find(".video-player").addClass("video-player--inactive"),i.$selection.find(".media-carousel__selection__photo--active").removeClass("media-carousel__selection__photo--active"),i.$initial.toggleClass("media-carousel__selection__initial--hide",!e).css("display","")},lockHeight:function(e){var i=this;i.$selection.css("min-height",""),e||i.$selection.css("min-height",i.$selection.height())},onSelection:function(e){var i=this;i.doTransition(),"video"!==e.type&&s.mediaCarouselImages.hasOwnProperty(e.id)?(i.reset(!1),i.getImageEl(e).addClass("media-carousel__selection__photo--active"),i.$wrap.toggleClass("media-carousel__selection-wrap--caption",0<e.$caption.length).removeClass("media-carousel__selection-wrap--caption-active"),setTimeout(function(){e.$caption.length?i.$selectionCaption.html(e.$caption.clone()):i.$selectionCaption.empty()},600)):i.$selection.find(".media-carousel__selection__photo--active").removeClass("media-carousel__selection__photo--active")},doTransition:function(){var e=this;e.scrollWindow(),e.lockHeight(),e.$selection.addClass("media-carousel__selection--transition"),setTimeout(function(){e.$selection.removeClass("media-carousel__selection--transition"),e.lockHeight(!0)},150)},getImageEl:function(e){var i=this.$selection.find("#image_"+e.id);return i.length||((i=l("<div>")).attr({id:"image_"+e.id,class:"media-carousel__selection__photo"}),i.html(s.mediaCarouselImages[e.id]),this.$selection.append(i)),i},scrollWindow:function(){var i=this;i.bus.resetting||setTimeout(function(){var e=i.$selection.offset().top-Estarossa.applyFilters("header-height");Estarossa.viewport.scrollPosition().top>e&&l("html, body").animate({scrollTop:e},350)},150)}},a.prototype={onClick:function(e){e.preventDefault();e=l(e.currentTarget);this.bus.doAction("selected",new i(e))},reset:function(){var e=this;e.$slider.trigger("to.owl.carousel",0),e.bus.doAction("selected",new i(e.$links.first()))},onSelect:function(e){this.$links.removeClass("selected"),e.$el.addClass("selected")},alignNav:function(){this.$nav.css("top",this.$slider.find(".media-carousel__link").outerHeight()/2)},onSlideChange:function(e){"position"===e.property.name&&(Estarossa.updateLayout(),this.bus.doAction("navigate",e))}},l(".media-carousel").each(function(){new e(l(this))})},9)}(window,(document,jQuery));