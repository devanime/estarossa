!function(o,r,i){var a=r.doAction,s=r.addAction,n=r.removeAction,l=(r.addFilter,r.applyFilters),d=(r.removeFilter,r.GTM_INTERACTION),h="vimeo",c="youtube",t={};t[h]=new e(h,"https://player.vimeo.com/api/player.js","Vimeo"),t[c]=new e(c,"https://www.youtube.com/iframe_api",function(){return window.hasOwnProperty("YT")&&void 0!==YT.Player});var u=r.VIDEO_PAUSE="videoPause";function p(t,e){e=Math.round(e.height/e.width*1e4)/100,t.css("padding-top",e+"%")}function f(t,e,i){return{type:"video",action:t,label:e.title,provider:e.service,url:e.url,id:e.id,$el:i}}function v(t){var e,i=this;if("string"!=typeof t&&"number"!=typeof t)throw new TypeError("VideoSource expects a string");i.id="",i.service="",i.url="",i.thumbnailReplace=["",""],i.thumbnailWidth=1264,i.thumbnailHeight=711,t=(t=(t=t.toString().trim()).replace("-nocookie","")).replace("/www.","/"),!/\/\/google/.test(t)||(e=t.match(/url=([^&]+)&/))&&(t=decodeURIComponent(e[1])),/youtube|youtu\.be|i.ytimg\./.test(t)?(i.id=i.youtube(t),i.service=c):/vimeo/.test(t)?(i.id=i.vimeo(t),i.service=h):!isNaN(parseFloat(t))&&isFinite(t)?(i.id=t,i.service=h):(i.id=t,i.service=c),i.service===c?(i.url="https://www.youtube.com/watch?v="+i.id,i.thumbnailReplace=["hqdefault","maxresdefault"]):i.service===h&&(i.url="https://vimeo.com/"+i.id,i.thumbnailReplace=[/_.+?\.jpg/,"_"+i.thumbnailHeight+".jpg"])}function e(t,e,i){this.name=t,this.url=e,this.loadConfirmation=i,this.requested=!1,this.deferred=o.Deferred()}function g(t){this.id="",this.service="",this.height=0,this.width=0,this.title="",this.description="",this.img="",this.url="",this.thumbnailReplace="",this.thumbnailWidth="",this.thumbnailHeight="",this._deferred=!1,r.whitelistAssign(this,t),this.height=parseInt(this.height),this.width=parseInt(this.width),this.start=0,this._setStart()}function y(){this._videos={},this._hasStorage=r.storageAvailable("sessionStorage")}window.location.origin||(window.location.origin=window.location.protocol+"//"+window.location.hostname+(window.location.port?":"+window.location.port:"")),s("video.playing",function(t,e){a(d,f("start",t,e))}),s("video.paused",function(t,e){a(d,f("pause",t,e))}),s("video.progress",function(t,e,i){a(d,o.extend(f("progress",t,e),{progress:i.progress}))}),v.prototype.vimeo=function(t){var e,i;return-1<(t=-1<t.indexOf("#")?t.split("#")[0]:t).indexOf("?")&&-1===t.indexOf("clip_id=")&&(t=t.split("?")[0]),/https?:\/\/vimeo\.com\/[0-9]+$|https?:\/\/player\.vimeo\.com\/video\/[0-9]+$|https?:\/\/vimeo\.com\/channels|groups|album/gim.test(t)?(i=t.split("/"))&&i.length&&(e=i.pop()):/clip_id=/gim.test(t)&&(i=t.split("clip_id="))&&i.length&&(e=i[1].split("&")[0]),e},v.prototype.youtube=function(t){var e=this,i=/youtube:\/\/|https?:\/\/youtu\.be\//g;if(i.test(t)){var n=t.split(i)[1];return e.stripParameters(n)}n=/\/v\/|\/vi\//g;if(n.test(t)){var r=t.split(n)[1];return e.stripParameters(r)}r=/v=|vi=/g;if(r.test(t))return t.split(r)[1].split("&")[0];r=/\/an_webp\//g;if(r.test(t)){var o=t.split(r)[1];return e.stripParameters(o)}o=/\/embed\//g;if(o.test(t)){o=t.split(o)[1];return e.stripParameters(o)}if(/\/user\//g.test(t)){var a=t.split("/");return e.stripParameters(a.pop())}a=/\/attribution_link\?.*v%3D([^%&]*)(%26|&|$)/;return a.test(t)?t.match(a)[1]:void 0},v.prototype.stripParameters=function(t){return-1<t.indexOf("?")?t.split("?")[0]:-1<t.indexOf("/")?t.split("/")[0]:t},e.prototype.load=function(){var i=this;return i.requested||i._checkLoad()||r.loadScript(i.name,i.url).then(function(){var t,e;i._checkLoad()||(e=0,t=setTimeout(function(){e&&(clearInterval(e),i.deferred.reject())},5e3),e=setInterval(function(){i._checkLoad()&&(clearTimeout(t),clearInterval(e))},250))}),i.requested=!0,i.deferred.promise()},e.prototype._checkLoad=function(){var t=o.isFunction(this.loadConfirmation)?this.loadConfirmation():window.hasOwnProperty(this.loadConfirmation);return t&&this.deferred.resolve(this),t},o.extend(g.prototype,{load:function(){var e=this,t=!1;return e._deferred||(t=!0,e._deferred=o.Deferred()),0<e.height?e._deferred.resolve(e):t&&o.getJSON("https://noembed.com/embed",{format:"json",url:e.url},function(t){if(t.error)e._deferred.reject(e);else{r.whitelistAssign(e,t);try{e.img={src:e.thumbnailReplace?String.prototype.replace.apply(t.thumbnail_url,e.thumbnailReplace):t.thumbnail_url,srcFallback:t.thumbnail_url,width:e.thumbnailWidth,height:e.thumbnailHeight},e._deferred.resolve(e)}catch(t){e._deferred.reject(e)}}}),e._deferred.promise()},_toObj:function(){var i={};return o.each(this,function(t,e){0===t.indexOf("_")||o.isFunction(e)||(i[t]=e)}),i},_setStart:function(){var t,e,i=function(t){var e={query:{},hash:{}};function i(t){var i={},t=t.split("&");return o.each(t,function(t,e){e=e.split("=");i[e[0]]=e[1]}),i}var n=t.split("?");1<n.length&&(e.query=i(n.pop()));t=t.split("#");return 1<t.length&&(e.hash=i(t.pop())),e}(this.url);switch(this.service){case c:i.query.hasOwnProperty("t")&&(this.start=i.query.t);break;case h:i.hash.hasOwnProperty("t")&&(this.start=(t=i.hash.t,e=t.split("m"),t=0,60*(t=1<e.length?parseInt(e[0]):t)+parseInt(e.pop())))}}}),o.extend(y.prototype,{find:function(t){var e,i=this,n=i._getFromPage(t);n||(t=(e=new v(t)).id,n=i._getFromList(t)||i._getFromStorage(t)||i._createFromSrc(e));n=n.load();return n.done(function(t){i.add(t)}).fail(function(t){}),n.promise()},_getFromList:function(t){return!!this._videos.hasOwnProperty(t)&&this._videos[t]},_getFromPage:function(t){if(window.videoCache&&window.videoCache.hasOwnProperty(t))return new g(window.videoCache[t])},_getFromStorage:function(t){if(this._hasStorage){t=sessionStorage.getItem("video_"+t);if(t)return new g(JSON.parse(t))}return!1},_createFromSrc:function(t){return new g(t)},_store:function(t){this._hasStorage&&sessionStorage.setItem("video_"+t.id,JSON.stringify(t._toObj()))},add:function(t){this._videos[t.id]=t,this._store(t)}}),r.videoRepository=new y;var m,_,b,w,P,$,I={init:function(t,e,i){var n=this;n.video=t,n.$container=e,n.$container.addClass("video-player video-player--inactive"),n.options=i||{},n.isMobile=r.isMobile,p(n.$container,n.video),n._progress=[25,50,75,95],n._getService().then(function(){n._setupContainer(),n._createPlayer()})},_tick:function(){var t={position:Math.round(this.position()),duration:Math.round(this.duration()),percent:Math.round(this.position()/this.duration()*100)};this._checkProgress(t)},_checkProgress:function(t){var e=this._progress[0]||!1;e&&t.percent>=e&&(95<=(e=this._progress.shift())&&(e=100),this._publish("progress",{progress:e}))},show:function(){this.$container.removeClass("video-player--inactive")},hide:function(){this.$container.addClass("video-player--inactive")},play:function(){this._publish("play"),this.show(),this._playerAPI("play")},pause:function(){this._playerAPI("pause")},stop:function(){this._playerAPI("stop")},mute:function(){this._playerAPI("mute")},unMute:function(){this._playerAPI("unMute")},destroy:function(){this._playerAPI("destroy")},reset:function(){this.stop(),this.hide()},onStateChange:function(t){this._publish(t)},isPlaying:function(){return 1===this._playerAPI("getPlayerState")},duration:function(){return this._playerAPI("getDuration")},position:function(){return this._playerAPI("getCurrentTime")},_publish:function(t,e){a("video."+t,this.video,this.$container,e),this.$container.trigger("video."+t,e)},_setupContainer:function(){var t=o("<span/>"),e=this.$container.data("origHtml")||this.$container.html();this.$container.data("origHtml",e),this.$container.html(t),this.el=t[0]},_getService:function(){return t[this.service].load()},_playerAPI:function(t,e){if(this._player&&"function"==typeof this._player[t])return this._player[t].apply(this._player,e)},_createPlayer:function(){}};function C(t,e,i){this.service=c,this.init(t,e,i),this._timer=!1}function A(t,e,i){this.service=h,this.init(t,e,i),this._duration=0,this._isPlaying=!1,this._curPos=0}function S(t){this.videos={},this.players={},this.$container=t,this.orig=this.$container.children(),this.current=!1,s("video.playing",this.pauseAll,10,this),s(u,this.pauseAll,10,this)}function T(t,e,i){this.$target=t,this.video=e,this.$el=o('<div class="video-meta">');var n=o('<div class="video-meta__title '+l("video/title-class","heading heading--large")+'">'+e.title+"</div>"),e=o('<div class="video-meta__description">'+e.description+"</div>");i.title&&this.$el.append(n),i.description&&this.$el.append(e),t.append(this.$el),s(u,this.onPause,10,this),s("video.play",this.onPlay,10,this)}function O(t,e){var i=this;i.el=t,i.$el=o(i.el),i.iLoaded=!1,i.options=e,i.init()}function k(t,e){var i=this;i.el=t,i.$el=o(i.el),i.options=e,i.pLoaded=!1,i.init()}function L(t,e){var i=this;i.el=t,i.$el=o(i.el),i.options=e,i.init()}o.extend(C.prototype,I,{_createPlayer:function(){var t=this,e=r.applyFilters("playerVars/youtube",{enablejsapi:1,modestbranding:1,iv_load_policy:3,rel:0,playsinline:1},t);t.video.start&&(e.start=t.video.start),t._player=new YT.Player(t.el,o.extend({},r.applyFilters("playerArgs/youtube",{},t),{height:t.video.height,width:t.video.width,videoId:t.video.id,title:t.video.title,playerVars:e,events:{onReady:function(){t._publish("ready")}.bind(t),onStateChange:t.onStateChange.bind(t)}}))},_initTimer:function(){var t=this;t._timer=t._timer||setInterval(function(){t.isPlaying()?t._tick():t._clearTimer()},1e3)},_clearTimer:function(){clearInterval(this._timer),this._timer=!1},play:function(){this._publish("play"),this.show(),this._playerAPI("playVideo")},stop:function(){this._playerAPI("stopVideo")},pause:function(){this._playerAPI("pauseVideo")},onStateChange:function(t){var e=this;switch(t.data){case YT.PlayerState.ENDED:e._clearTimer(),e._tick(),e._publish("ended");break;case YT.PlayerState.PLAYING:e._tick(),e._initTimer(),e._publish("playing");break;case YT.PlayerState.PAUSED:e._clearTimer(),e._publish("paused")}}}),o.extend(A.prototype,I,{_createPlayer:function(){var e=this,t=o.extend({},r.applyFilters("playerVars/vimeo",{url:"",enablejsapi:1,byline:!1,title:!1},e),{url:e.video.url,height:e.video.height,width:e.video.width,title:e.video.title});e._player=new Vimeo.Player(e.el,t),e._player.on("play",function(t){0===t.seconds&&e.video.start&&e._player.setCurrentTime(e.video.start),e._publish("playing")}),e._player.on("ended",function(){e._publish("ended")}),e._player.on("pause",function(){e._publish("paused")}),e._player.on("loaded",function(){e._publish("ready")}),e._player.on("timeupdate",i.throttle(e._updateState.bind(e),1e3,{leading:!0,trailing:!0}))},_updateState:function(t){var e=this;e._curPos=t.seconds,e._duration=t.duration,e._playerAPI("getPaused").then(function(t){e._isPlaying=!t,e._tick()})},isPlaying:function(){return this._isPlaying},duration:function(){return this._duration},position:function(){return this._curPos}}),o.extend(S.prototype,{add:function(t){var e=t.id;if(this.videos.hasOwnProperty(e))return this;var i=o("<div>");return this.$container.append(i),this.videos[e]=t,this.players[e]=t.service===h?this.players[e]=new A(t,i):this.players[e]=new C(t,i),this.current||this.select(t),this},select:function(t){this.currentVideo=this.videos[t.id],this.currentPlayer=this.players[t.id],this.current=t.id},play:function(t){return this.fixContainerHeight(),t&&this.select(t),a(u),this.orig.hide(),o.each(this.players,function(t,e){t!==this.current&&e.hide()}),this.currentPlayer.play(),this.fixContainerHeight(!0),this},pause:function(){return this.currentPlayer.pause(),this},playPause:function(t){return this.currentPlayer.isPlaying()?(this.pause(),t&&t.id!==this.current&&this.play(t)):this.play(t),this},pauseAll:function(i){return o.each(this.players,function(t,e){i&&i.id===t||e.pause()}),this},reset:function(){o.each(this.players,function(t,e){e.hide()}),this.orig.show()},fixContainerHeight:function(t){var e=this;t?setTimeout(function(){e.$container.css("min-height","")},50):e.$container.css("min-height",e.$container.height())}}),T.prototype={toggle:function(t){this.$el.toggleClass("video-meta--active",t)},onPlay:function(t,e){this.toggle(this.video===t)},onPause:function(){this.toggle(!1)}},_={forceLoad:!(m="videoThumb")},O.prototype={init:function(){var e=this;_.id=e.$el.data("videoId")||_.id,e.config=o.extend({},_,e.options,{image:e.$el.data("videoThumb")},e.$el.data("videoOptions")),(e.config.id?r.videoRepository.find(e.config.id):o.Deferred().reject()).done(function(t){e.video=t,e.$el.addClass("video-thumb--"+t.service),e.images=[e.config.image,t.img.src,t.img.srcFallback].filter(Boolean),s("video.lazyload",e.maybeLoadImage,10,e),e.replaceIcon(),e.forceAspect(),e.maybeLoadImage()})},forceAspect:function(){this.$el.hasClass("video-thumb--match-aspect")&&p(this.$el,this.video)},maybeLoadImage:function(){var e,i=this;!r.viewport.isInViewport(i.el)&&!i.config.forceLoad||i.iLoaded||(i.iLoaded=!0,(e=new Image).addEventListener("load",function(t){t=t.target;t.height<100?t.dispatchEvent(new Event("error")):(i.$el.find(".video-thumb__bg").css("background-image",'url("'+t.src+'")'),!i.$el.find(".video-thumb__icon").length||i.$el.hasClass("video-thumb--dark")||i.$el.hasClass("video-thumb--light")||r.imageBrightness(t.src,function(t){i.$el.addClass(t<50?"video-thumb--dark":"video-thumb--light")}),i.$el.hasClass("video-thumb--match-aspect")||p(i.$el,t),setTimeout(function(){i.$el.addClass("video-thumb--loaded").removeAttr("aria-hidden")},20),e=null)},!1),e.addEventListener("error",function(){i.images.length&&(e.src=i.images.shift())},!1),setTimeout(function(){n("video.lazyload",i.maybeLoadImage,i),e.src=i.images.shift()},5))},replaceIcon:function(){var t;"youtube"===this.video.service&&(t=o("<span>").addClass("video-thumb__yt").append(o('<svg><use xlink:href="#youtube-play"></use></svg>')),this.$el.find(".video-thumb__icon").html(t))}},o.fn[m]=function(i){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=o(this),e=o.data(this,m);e?"string"==typeof i&&e[i].apply(e,n):t.data(m,new O(this,i))})},w={forceLoad:!(b="videoTrigger")},k.prototype={init:function(){var e=this;e.$el.addClass("video--loading"),w.id=e.$el.data("videoId")||w.id,e.config=o.extend({},w,e.options,e.$el.data("videoOptions")),e.$target=e.getTargetEl(),(e.$target&&e.$target.hasClass("modal")||e.config.modal)&&(e.$target=e.$target.find(".modal__content")),s("video.ready",e.onVideoReady,10,e),(e.config.id?r.videoRepository.find(e.config.id):o.Deferred().reject()).done(function(t){e.video=t,!e.$target&&e.$el.is("a")&&e.$el.attr({href:t.url,target:"_blank"}),e.$el.attr("aria-label")||e.$el.attr("aria-label","Play Video - "+t.title),e.$el.data("gtm",!1),e.$target&&(e.$el.on("click",e.onClick.bind(e)),s("video.lazyload",e.registerPlayer,10,e),e.registerPlayer())})},getTargetEl:function(){var t=o(this.$el.data("target")).add(o(this.$el.attr("href"))).first();return 0<(t=!t.length&&this.$el.hasClass("video-thumb")?this.$el.wrap('<div class="video-player-container">').parent(".video-player-container"):t).length&&t},onClick:function(t){t.preventDefault(),this.$target.videoPlayer(this.video,"playPause")},onVideoReady:function(t){var e=this;e.video&&t.id===e.video.id&&setTimeout(function(){n("video.ready",e.onVideoReady,e),e.$el.removeClass("video--loading").addClass("video--loaded").removeAttr("aria-hidden")},5)},registerPlayer:function(){var t=this;!r.viewport.isInViewport(t.el)&&!t.config.forceLoad||t.pLoaded||(t.pLoaded=!0,setTimeout(function(){n("video.lazyload",t.registerPlayer,t),t.$target.videoPlayer(t.video),(t.config.title||t.config.description)&&new T(t.$target,t.video,t.config)},5))}},o.fn[b]=function(i){var n=Array.prototype.slice.call(arguments,1);return this.each(function(){var t=o(this),e=o.data(this,b);e?"string"==typeof i&&e[i].apply(e,n):t.data(b,new k(this,i))})},P="videoPlayer",$={},L.prototype={init:function(){var t=this;t.playlist=new S(t.$el),t.config=o.extend({},$,t.options,t.$el.data("videoOptions"))},playPause:function(t,e){this.playlist.playPause(t)},register:function(t,e){this.playlist.add(t)}},o.fn[P]=function(){for(var i=!1,n=!1,r=[],t=0;t<arguments.length;t++){var e=arguments[t];e instanceof g?i=e:"string"==typeof e?n=e:o.isPlainObject(e)&&(r=e)}return this.each(function(){var t=o(this),e=o.data(this,P);e||(e=new L(this,r),t.data(P,e)),n?e[n].call(e,i,r):e.register(i,r)})},r(function(t,e,i,n){t(".video-thumb").videoThumb(),s(r.USER_FIRST_INTERACTION,function(){t("[data-video-id]").videoTrigger()}),t.each([r.SCROLL,r.LAYOUT,r.HASH_STATE_CHANGE],function(t,e){s(e,function(){a("video.lazyload")})}),t.each(["hideModal"],function(t,e){s(e,function(){a(u)})})})}(jQuery,Estarossa,lodash);