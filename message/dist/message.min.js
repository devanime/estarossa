function Message(e){this.$el=e,this.$el.find(".message__close").click(this.close.bind(this)),this.id=this.$el.data("id"),this.messageCookie=new MessageCookie(this.id,this.$el.data("start"),this.$el.data("end"),this.$el.data("expiry")),this.messageCookie.isValid()?this.show():this._remove()}function MessageCookie(e,i,s,t){this.id=e,this.start=this._getTime(i),this.end=this._getTime(s),this.expiry=parseInt(t),this.now=dayjs(),this.expiry&&(this.expiry=dayjs().add(this.expiry,"s")),this.cookie="message-"+this.id,this._expiryMismatch()&&this.setCookie()}function MessageModal(e){this.modalID=e.modalID,this.$modal=jQuery("#"+this.modalID),this.trigger=e.trigger,this.delay=e.delay,this.scrollDistance=e.scrollDistance||5,this.showed=!1,this.messageCookie=new MessageCookie(e.id,e.start,e.end,e.expiry),this.messageCookie.isValid()&&this.$modal.length&&this.show()}Message.prototype={close:function(){this.messageCookie.setCookie(),this._remove()},show:function(){this.$el.addClass("message--show")},_remove:function(){this.$el.remove(),this.$el=!1}},MessageCookie.prototype={_getTime:function(e){if(e){e=dayjs(e);if(dayjs.isDayjs(e))return e}return!1},setCookie:function(){var e=!dayjs.isDayjs(this.expiry),i=!e&&{expires:this.expiry.toDate()},e=e?this.cookie:this.expiry.toISOString();Cookies.set(this.cookie,e,i)},isValid:function(){var e=!0;return e=this.start&&this.now.isBefore(this.start)||this.end&&this.now.isAfter(this.end)||Cookies.get(this.cookie)?!1:e},_expiryMismatch:function(){var e=Cookies.get(this.cookie);if(e&&e!==this.cookie){e=dayjs(e);if(dayjs.isDayjs(e)&&e.isAfter(this.expiry))return!0}return!1}},MessageModal.prototype={show:function(){var e=this,i="time"===e.trigger?1e3*e.delay:500;"scroll"===e.trigger&&jQuery(document).height()>Estarossa.viewport.height()?Estarossa.addAction("scroll",e._onScroll,10,e):setTimeout(e._show.bind(e),i)},_onScroll:function(e,i){var s=this,t=Estarossa.viewport.height(),o=jQuery(document).height();i.top/(o-t)*100>=s.scrollDistance&&!s.showed&&(s.showed=!0,setTimeout(function(){Estarossa.removeAction("scroll",s._onScroll,s),s._show()},0))},_show:function(){var e=this;e.showed=!0,Estarossa.doAction("showModal",e.$modal),e.$modal.one("click",function(){e.messageCookie.setCookie()})},_remove:function(){this.$modal.remove()}},Estarossa(Estarossa.READY,function(e,i,s,t){var o=Estarossa.addFilter,r=e(".message").filter(function(){return new Message(e(this)).$el});r.length&&(o("stickyHeader/triggerHeight",function(e){var i=r.first().height()||0;return e+(i=i?i+20:0)},5),o("css-vars/register",function(e){return e["navburger-top"]=function(){return"40px"},e},20)),s.messageModalData&&(s=s.messageModalData,Array.isArray(s)?s.forEach(function(e,i){new MessageModal(e)}):new MessageModal(s))});